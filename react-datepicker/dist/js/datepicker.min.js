!function(a,b){var c=(a.createElement,b.Datepicker),d=function(a){a instanceof Date||(a=new Date);var b=this;b.init={},b.init.y=b.y=a.getFullYear(),b.init.m=b.m=a.getMonth()+1,b.init.d=b.d=a.getDate()},e=d.prototype;e.toDate=function(){var a=this;return new Date(a.y,a.m-1,a.d)},e.monthDays=[1,-2,1,0,1,0,1,1,0,1,0,1],e.nextMonth=function(){var a=this;return 12==a.m?(a.y+=1,a.m=1):a.m+=1,a.d=1,a},e.prevMonth=function(){var a=this;return 1==a.m?(a.y-=1,a.m=12):a.m-=1,a.d=1,a},e.getMonthDays=function(){var a=this,b=2==a.m&&(a.y%4==0&&a.y%100!=0||a.y%400==0)?1:0;return a.monthDays[a.m-1]+30+b},e.format=function(a){var b=this,c={"M+":b.m,"d+":b.d,"q+":Math.floor((b.m+2)/3)};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(b.y+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return a};var f={zh:{dayTitle:["一","二","三","四","五","六","日"],monthTitle:["一","二","三","四","五","六","七","八","九","十","十一","十二"].map(function(a){return a+"月"}),dateTitle:function(a,b){return a+" 年 "+b+" 月"}}},g="c",h="i",k="am-datepicker-",l={BASIC:k+"day",ACTIVE:k+"day am-active",DISABLED:k+"day am-disabled",CURRENT:k+"day am-current"},m=yearClassSet={BASIC:"",ACTIVE:"am-active",CURRENT:"am-current",DISABLED:"am-disabled"},n=function(a){var b,c=(a.from,a.to,a.current),e=0,f=0,i=0,j=0,k={},l=c.toDate(),m=new d(l).prevMonth().getMonthDays(),n=(new d(l).nextMonth().getMonthDays(),c.getMonthDays());l.setDate(1);for(var o=(l.getDay()+6)%7;o>e;e++,j++)k[g+j]=-1,k[h+j]=m-o+1+e;for(;n>f;f++,j++)k[g+j]=0,k[h+j]=f+1;for(;42-n-o>i;i++,j++)k[g+j]=-1,k[h+j]=i+1;return c.y==c.init.y&&c.m==c.init.m&&(k[g+(o+c.init.d-1)]=2),b=o+c.d-1,k[g+b]=1,{active:b,obj:k}},o=function(a){for(var b,c=(a.from,a.to,a.current),d=0,e={};12>d;d++)e[g+d]=0,e[h+d]=d+1;return c.y==c.init.y&&(e[g+(c.init.m-1)]=2),b=c.m-1,e[g+b]=1,{active:b,obj:e}},p=function(a){for(var b,c=(a.from,a.to,a.current),d=0,e={},f=c.y,i=f%12,j=f-i;12>d;d++)e[g+d]=0,e[h+d]=j+d;return c.init.y-c.init.y%12==j&&(e[g+c.init.y%12]=2),b=i,e[g+b]=1,{active:b,obj:e}},q=function(a,b,c){var d=null,e=c;switch(a){case-1:d=b.DISABLED,e=null;break;case 0:d=b.BASIC;break;case 1:d=b.ACTIVE;break;case 2:d=b.CURRENT}return[d,e]},r={active:null,getInitialState:function(){var a=this,b=a.caculate(a.props);return a.active=b.active,b.obj},componentWillReceiveProps:function(a){var b=this,c=b.caculate(a);b.active=c.active,b.setState(c.obj)},onClick:function(a,b){b.stopPropagation();var c=this,d=c.active,e={};null!==d&&d!==a&&1===c.state[g+d]&&(e[g+d]=0),d!==a&&(e[g+a]=2==c.state[g+a]?2:1,c.active=a),c.props.select(c.state[h+a])}},s=a.createClass({displayName:"DatepickerDayTbody",mixins:[r],caculate:n,render:function(){var b=this,c=[];for(i=0;i<6;i++){var d=[];for(j=0;j<7;j++){var e=7*i+j,f=q(b.state[g+e],l,b.onClick.bind(b,e)),k=f[0],m=f[1];d.push(a.createElement("td",{key:e,className:k,onClick:m},b.state[h+e]))}c.push(a.createElement("tr",{key:i},d))}return a.createElement("tbody",null,c)}}),t=a.createClass({displayName:"DatepickerMonthTbody",mixins:[r],caculate:o,render:function(){for(var b,c,d,e=this,i=[],j=0,k=f[e.props.lang]||f.zh;12>j;j++)d=q(e.state[g+j],m,e.onClick.bind(e,j)),b=d[0],c=d[1],i.push(a.createElement("span",{key:"m-"+j,className:b,onClick:c},k.monthTitle[e.state[h+j]-1]));return a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",{colSpan:"7"},i)))}}),u=a.createClass({displayName:"DatepickerYearTbody",mixins:[r],caculate:p,render:function(){for(var b,c,d,e=this,f=[],i=0;12>i;i++)d=q(e.state[g+i],yearClassSet,e.onClick.bind(e,i)),b=d[0],c=d[1],f.push(a.createElement("span",{key:"y-"+i,className:b,onClick:c},e.state[h+i]));return a.createElement("tbody",null,a.createElement("tr",null,a.createElement("td",{colSpan:"7"},f)))}}),v=a.createClass({displayName:"DatepickerPanel",getDefaultProps:function(){return{from:null,to:null,current:new d,select:null}},getInitialState:function(){var a=this.props;return{panel:a.panel,current:a.current}},componentWillReceiveProps:function(a){this.setState({current:a.current})},changePanel:function(){var a=this;this.setState({panel:a.state.panel+1})},selectDay:function(a){var b=this,c=b.state.current;c.d=a,b.setState({current:c}),b.props.select(c)},selectPanel:function(a,b){var c=this,d=c.state.current;1==a?(d.m=b,b!=d.init.m&&(d.d=1)):(d.y=b,b!=d.init.y&&(d.d=1)),this.setState({current:d,panel:a})},onWheel:function(a){a.preventDefault(),this.goIcon(a.deltaY>0?1:-1)},goIcon:function(a,b){b&&b.stopPropagation();var c=this;stateArgs=c.state,propArgs=c.props,1==stateArgs.panel?a>0?stateArgs.current.nextMonth():stateArgs.current.prevMonth():2==stateArgs.panel?stateArgs.current.y+=a>0?1:-1:3==stateArgs.panel&&(stateArgs.current.y+=a>0?12:-12),c.setState({current:stateArgs.current})},render:function(){var b=this;if(stateArgs=b.state,propArgs=b.props,_lang=f[propArgs.lang]||f.zh,table=null,tableClass=k+"table",headClass=k+"header",switchClass=k+"switch",selectClass=k+"select",prevTh=a.createElement("th",{className:k+"prev"},a.createElement("i",{className:k+"prev-icon",onClick:b.goIcon.bind(b,1)})),nextTh=a.createElement("th",{className:k+"next"},a.createElement("i",{className:k+"next-icon",onClick:b.goIcon.bind(b,-1)})),1==stateArgs.panel)table=a.createElement("table",{className:tableClass},a.createElement("thead",null,a.createElement("tr",{className:headClass},prevTh,a.createElement("th",{colSpan:"5",className:switchClass},a.createElement("div",{className:selectClass,onClick:b.changePanel},_lang.dateTitle(stateArgs.current.y,stateArgs.current.m,stateArgs.d))),nextTh),a.createElement("tr",null,_lang.dayTitle.map(function(b,c){return a.createElement("th",{key:"th-"+c,className:k+"dow"},b)}))),a.createElement(s,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:b.selectDay}));else if(2==stateArgs.panel)table=a.createElement("table",{className:tableClass},a.createElement("thead",null,a.createElement("tr",{className:headClass},prevTh,a.createElement("th",{colSpan:"5",className:switchClass},a.createElement("div",{className:selectClass,onClick:b.changePanel},stateArgs.current.y)),nextTh)),a.createElement(t,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,lang:propArgs.lang,select:b.selectPanel.bind(b,1)}));else if(3==stateArgs.panel){var c=stateArgs.current.y-stateArgs.current.y%10;table=a.createElement("table",{className:tableClass},a.createElement("thead",null,a.createElement("tr",{className:headClass},prevTh,a.createElement("th",{colSpan:"5",className:switchClass},a.createElement("div",{className:selectClass},c,"-",c+11)),nextTh)),a.createElement(u,{from:propArgs.from,to:propArgs.to,current:stateArgs.current,select:b.selectPanel.bind(b,2)}))}return a.createElement("div",{className:"am-datepicker",style:{display:"block"},onWheel:b.onWheel},a.createElement("div",{className:k+"days",style:{display:"block"}},table))}}),w=a.createClass({displayName:"DatepickerInput",getDefaultProps:function(){return{from:null,to:null,current:new d,format:"yyyy-MM-dd",onSelect:null,lang:"zh",panel:1}},getInitialState:function(){var a=this.props;return{visible:!1,current:new d(a.current)}},componentWillReceiveProps:function(a){this.setState({visible:!1,current:a.current})},onClick:function(a){a.stopPropagation();var b=this;this.setState({visible:!b.state.visible})},onSelect:function(a){var b=this,c=b.props.onSelect;"function"==typeof c&&c(a.toDate()),b.setState({visible:!1,current:a})},render:function(){var b=this,c=b.state,d=b.props;return a.createElement("div",null,a.createElement("input",{type:"text",className:k+"input-field",value:c.current.format(d.format),onClick:b.onClick}),a.createElement("div",{style:{display:c.visible?null:"none"}},a.createElement(v,{from:d.from,to:d.to,panel:d.panel,current:c.current,lang:d.lang,select:b.onSelect})))}});b.Datepicker=w,w.noConflict=function(){return b.Datepicker=c,w},w.addLang=function(a,b){f[a]=b}}(React,window);