!function(a,b){var c=a.createElement;Date.prototype.Format=function(a){var b={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),S:this.getMilliseconds()};/(y+)/.test(a)&&(a=a.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var c in b)new RegExp("("+c+")").test(a)&&(a=a.replace(RegExp.$1,1==RegExp.$1.length?b[c]:("00"+b[c]).substr((""+b[c]).length)));return a};var d=[1,-2,1,0,1,0,1,1,0,1,0,1],e=["一","二","三","四","五","六","七","八","九","十","十一","十二"],f="c",g="i",h="am-datepicker-",k={BASIC:h+"day",ACTIVE:h+"day am-active",DISABLED:h+"day am-disabled",CURRENT:h+"day am-current"},l=yearClassSet={BASIC:"",ACTIVE:"am-active",CURRENT:"am-current"},m=function(a,b,c){var d=new Date;return d.setFullYear(a),d.setMonth(b),d.setDate(c),d},n=function(a,b){return m(a,b,1).getDay()},o=function(a,b){var c=2==b&&(a%4==0&&a%100!=0||a%400==0)?1:0;return d[b-1]+30+c},p=function(a,b,c){var d,e,h,i=0,j={},k=o(a,b),l=o(1==b?a-1:a,1==b?12:b-1),m=(o(12==b?a+1:a,12==b?1:b+1),n(a,b)),m=1==m?7:m?m-1:6;for(d=0;m>d;d++,i++)j[f+i]=-1,j[g+i]=l-m+1+d;for(e=0;k>e;e++,i++)j[f+i]=0,j[g+i]=e+1;for(h=0;42-k-m>h;h++,i++)j[f+i]=-1,j[g+i]=h+1;return c?j[f+(m+c-1)]=2:j[f+m]=1,{active:c?""+(m+c-1):""+m,obj:j}},q=function(a){for(var b={},c=0;12>c;c++)b[f+c]=0,b[g+c]=c+1;return a?b[f+(a-1)]=2:b[f+"0"]=1,{active:a?""+(a-1):"0",obj:b}},r=function(a,b){for(var c={},d=0;12>d;d++)c[f+d]=0,c[g+d]=a+d;return b?c[f+(b-a)]=2:c[f+"0"]=1,{active:b?""+(b-a):"0",obj:c}},s={activeItem:null,getInitialState:function(){var a=this.getCaculate(this.props);return this.activeItem=a.active,a.obj},componentWillReceiveProps:function(a){var b=this.getCaculate(a);this.activeItem=b.active,this.setState(b.obj)},onClick:function(a,b){b&&b.stopPropagation();var c=this.activeItem,d={};null!==c&&c!==a&&1===this.state[f+c]&&(d[f+c]=0),c!==a&&(d[f+a]=2==this.state[f+a]?2:1,this.activeItem=a,this.setState(d)),this.props.select(this.state[g+a])}},t=a.createClass({displayName:"DatepickerDayTbody",mixins:[s],getCaculate:function(a){return p(a.year,a.month,a.day)},render:function(){var a=[];for(i=0;i<6;i++){var b=[];for(j=0;j<7;j++){var d,e=7*i+j,h=this.onClick.bind(this,e);switch(this.state[f+e]){case-1:d=k.DISABLED,h=null;break;case 0:d=k.BASIC;break;case 1:d=k.ACTIVE;break;case 2:d=k.CURRENT}b.push(c("td",{key:e,className:d,onClick:h},this.state[g+e]))}a.push(c("tr",{key:i},b))}return c("tbody",null,a)}}),u=a.createClass({displayName:"DatepickerMonthTbody",mixins:[s],getCaculate:function(a){return q(a.month)},render:function(){for(var a,b,d=[],h=0;12>h;h++){switch(b=this.onClick.bind(this,h),this.state[f+h]){case 0:a=l.BASIC;break;case 1:a=l.ACTIVE;break;case 2:a=l.CURRENT}d.push(c("span",{key:"m-"+h,className:a,onClick:b},e[this.state[g+h]-1]+"月"))}return c("tbody",null,c("tr",null,c("td",{colSpan:"7"},d)))}}),v=a.createClass({displayName:"DatepickerYearTbody",mixins:[s],getCaculate:function(a){return r(a.start,a.year)},render:function(){for(var a,b,d=[],e=0;12>e;e++){switch(b=this.onClick.bind(this,e),this.state[f+e]){case 0:a=yearClassSet.BASIC;break;case 1:a=yearClassSet.ACTIVE;break;case 2:a=yearClassSet.CURRENT}d.push(c("span",{key:"y-"+e,className:a,onClick:b},this.state[g+e]))}return c("tbody",null,c("tr",null,c("td",{colSpan:"7"},d)))}}),w=a.createClass({displayName:"DatepickerPanel",getInitialState:function(){var a=this.props.year,b=this.props.month,c=this.props.day;return{year:a,month:b,day:c,panel:1}},changePanel:function(){this.setState({panel:this.state.panel+1})},selectDay:function(a){this.props.select(this.state.year,this.state.month,a)},selectMonth:function(a){var b=this.state.year,c=b==this.props.year&&a==this.props.month?this.props.day:null;this.setState({month:a,day:c,panel:1})},selectYear:function(a){this.state.month;this.setState({year:a,panel:2})},onWheel:function(a){a.preventDefault(),a.deltaY>0?this.goNext():this.goPrev()},goPrev:function(a){if(a&&a.stopPropagation(),1==this.state.panel){var b=this.state.year-(1==this.state.month?1:0),c=1==this.state.month?12:this.state.month-1,d=b==this.props.year&&c==this.props.month?this.props.day:null;this.setState({year:b,month:c,day:d})}else if(2==this.state.panel){var b=this.state.year-1,c=b==this.props.year?this.props.month:null;this.setState({year:b,month:c,day:null})}else if(3==this.state.panel){var b=this.state.year-12,c=b==this.props.year?this.props.month:null;this.setState({year:b,month:c,day:null})}},goNext:function(a){if(a&&a.stopPropagation(),1==this.state.panel){var b=this.state.year+(12==this.state.month?1:0),c=12==this.state.month?1:this.state.month+1,d=b==this.props.year&&c==this.props.month?this.props.day:null;this.setState({year:b,month:c,day:d})}else if(2==this.state.panel){var b=this.state.year+1,c=b==this.props.year?this.props.month:null;this.setState({year:b,month:c,day:null})}else if(3==this.state.panel){var b=this.state.year+12,c=b==this.props.year?this.props.month:null;this.setState({year:b,month:c,day:null})}},render:function(){var a=null,b=h+"table",d=h+"header",e=h+"switch",f=h+"select",g=c("th",{className:h+"prev"},c("i",{className:h+"prev-icon",onClick:this.goPrev})),i=c("th",{className:h+"next"},c("i",{className:h+"next-icon",onClick:this.goNext}));if(1==this.state.panel)a=c("table",{className:b,onWheel:this.onWheel},c("thead",null,c("tr",{className:d},g,c("th",{colSpan:"5",className:e},c("div",{className:f,onClick:this.changePanel},this.state.year,"年",this.state.month,"月")),i),c("tr",null,["一","二","三","四","五","六","日"].map(function(a,b){return c("th",{key:"th-"+b,className:h+"dow"},a)}))),c(t,{year:this.state.year,month:this.state.month,day:this.state.day,select:this.selectDay}));else if(2==this.state.panel)a=c("table",{className:b,onWheel:this.onWheel},c("thead",null,c("tr",{className:d},g,c("th",{colSpan:"5",className:e},c("div",{className:f,onClick:this.changePanel},this.state.year)),i)),c(u,{month:this.state.month,select:this.selectMonth}));else if(3==this.state.panel){var j=this.state.year-this.state.year%10,k=j==this.props.year-this.props.year%10?this.props.year:null;a=c("table",{className:b,onWheel:this.onWheel},c("thead",null,c("tr",{className:d},g,c("th",{colSpan:"5",className:e},c("div",{className:f},j,"-",j+9)),i)),c(v,{start:j,year:k,select:this.selectYear}))}return c("div",{className:"am-datepicker",style:{display:"block"},onWheel:this.onWheel},c("div",{className:h+"days",style:{display:"block"}},a))}});DatepickerInput=a.createClass({displayName:"DatepickerInput",isMouseOver:!1,getInitialState:function(){return{visible:!1,value:this.props.date.Format(this.props.format)}},onClick:function(){!this.isMouseOver&&this.setState({visible:!this.state.visible})},select:function(a,b,c){var d=m(a,b,c);"function"==typeof this.props.select&&this.props.select(d),this.setState({visible:!1,value:d.Format(this.props.format)})},render:function(){return c("div",{className:"am-input-group"},c("input",{type:"text",className:"am-form-field",value:this.state.value,onClick:this.onClick}),c("div",{style:this.state.visible?null:{display:"none"}},c(w,{year:this.props.date.getFullYear(),month:this.props.date.getMonth()+1,day:this.props.date.getDate(),select:this.select})))}}),b.Datepicker=function(b,d){d.date||(d.date=new Date),d.format||(d.format="yyyy-MM-dd"),a.render(c(DatepickerInput,{date:d.date,format:d.format,select:d.onSelect}),b)}}(React,window);